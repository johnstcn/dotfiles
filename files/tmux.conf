# Use screen-style prefix (Ctrl-A instead of Ctrl-B)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Reload config with prefix+r
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Use 256 colors
set -g default-terminal "screen-256color"

# Start window/pane numbering at 1 (easier to reach on keyboard)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase scrollback buffer
set -g history-limit 10000

# Enable mouse support (for those rare times you need it)
set -g mouse on

# Mouse drag to reorder windows on status bar
bind -n MouseDrag1Status swap-window -t=

# Double-click on status bar to create new window
bind -n DoubleClick1Status new-window

# Right-click on window status to kill window
bind -n MouseDown3Status kill-window

# Mouse wheel scrolls history (not commands) when not in alt screen
bind -n WheelUpPane if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; copy-mode -e; send-keys -M"
bind -n WheelDownPane select-pane -t = \; send-keys -M

# Middle-click on pane to paste
bind -n MouseDown2Pane paste-buffer

# Drag to re-order windows
bind -n MouseDrag1Status swap-window -d -t=

# Click pane to select (but pass through to app if in alternate screen like nvim)
bind -n MouseDown1Pane select-pane -t= \; if-shell -F "#{alternate_on}" "send-keys -M"

# No delay for escape key (helps with vim)
set -sg escape-time 0

# Aggressive resize (useful when multiple clients)
setw -g aggressive-resize on

# Activity monitoring
setw -g monitor-activity on
set -g visual-activity off

# Screen-style window splitting
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Rename window (Ctrl-A A for screen compatibility, Ctrl-A , for tmux default)
bind A command-prompt -I "#W" "rename-window '%%'"
bind , command-prompt -I "#W" "rename-window '%%'"

# Easier pane navigation (Alt+arrow without prefix)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Vim-style pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Equal split - distribute panes evenly
bind = select-layout tiled

# Status bar
set -g status on
set -g status-interval 1
set -g status-position bottom
set -g status-justify left

# Status bar colors (subtle and professional)
set -g status-style bg=colour235,fg=colour250

# Current window in bold
setw -g window-status-current-style fg=colour255,bg=colour238,bold

# Window status format
setw -g window-status-format " #I:#W#F "
setw -g window-status-current-format " #I:#W#F "

# Left status: session name
set -g status-left-length 20
set -g status-left "#[fg=colour39,bold] #S #[default]"

# Right status: hostname, load, date/time
set -g status-right-length 80
set -g status-right "#[fg=colour244]#H #[fg=colour250]| #[fg=colour244]%Y-%m-%d #[fg=colour250]%H:%M:%S "

# Pane border colors
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour39

# Message colors
set -g message-style bg=colour235,fg=colour39,bold

# Copy mode (vim-style)
setw -g mode-keys vi
bind [ copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi Escape send -X cancel

# Mouse selection in copy mode
bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-selection-and-cancel
bind -T copy-mode-vi DoubleClick1Pane select-pane \; send -X select-word \; send -X copy-selection-and-cancel
bind -T copy-mode-vi TripleClick1Pane select-pane \; send -X select-line \; send -X copy-selection-and-cancel

# Double-click to select word (but pass through if in alternate screen)
bind -n DoubleClick1Pane if-shell -F "#{alternate_on}" "send-keys -M" "select-pane \; copy-mode \; send -X select-word \; send -X copy-selection-and-cancel"

# Triple-click to select line (but pass through if in alternate screen)
bind -n TripleClick1Pane if-shell -F "#{alternate_on}" "send-keys -M" "select-pane \; copy-mode \; send -X select-line \; send -X copy-selection-and-cancel"

# Paste buffer
bind ] paste-buffer
